<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <input type="text" class="search" [(ngModel)]="searchText" placeholder="Search">
</div>

<div class="pricing-header mx-auto">
  <div class="no-data text-center" *ngIf="preLoader">
  </div>

  <div class="no-data text-center" *ngIf="noData">
    <p class="nodata-msg">No donor added yet!</p>
    <a routerLink="/home/{{currentUser?.uid}}/add" class="btn btn-success"> Add Donor </a>
  </div>

  <div class="table-responsive" *ngIf="hideWhenNoDonor">
    <table class="table table-bordered table-responsive-sm table-responsive-md table-responsive-lg">
      <thead class="table-head">
        <tr>
          <th scope="col">Donor Details</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="
            let donor of donors
              | filter: searchText
              | paginate: { itemsPerPage: 10, currentPage: p };
            let i = index
          ">
          <td class="p-0">
            <div class=" p-2 d-flex justify-content-between align-items-center" style="cursor: pointer;"
              (click)="donor.opened = !donor.opened ">
              <div class="row align-items-end flex-grow-1 mx-0">
                <span class="col-md-6 px-0" [ngStyle]="{'color':donor.color}">
                  <i class="fas fa-caret-right m-0" *ngIf="!donor.opened"></i>
                  <i class="fas fa-caret-down m-0" *ngIf="donor.opened"></i>
                  {{ donor.name }}
                </span>
                <span class="col-md-6 font-sm">{{donor.district}}</span>
                <span *ngIf="donor.lastDonated" class="col-md-6 font-sm">last donated
                  {{donor.lastDonated | timeAgo}} ({{donor.lastDonated| date}})</span>
                <span *ngIf="!donor.lastDonated" class="col-md-6 font-sm">last donated
                  info not available
                </span>
              </div>
              <span class="border-1 border px-2 rounded border-info">{{ donor.group }}</span>
            </div>
            <div *ngIf="donor.opened" class="bg-info-subtle">
              <div *ngIf="isAdmin || donor.isSameCreator" class="action-block d-flex justify-content-evenly py-2">
                <span class=" me-2 btn btn-outline-success btn-sm" title="Copy Contact">
                  <a href="tel:{{donor.mobileNumber}}"><em class="fas fa-phone fa-rotate-90"></em></a>
                </span>
                <span class=" me-2 btn btn-outline-primary btn-sm" (click)="copyContact(donor)" title="Share">
                  <em class="far fa-copy"></em>
                </span>
                <span class="me-2 btn btn-outline-primary btn-sm" title="Edit"
                  routerLink="/home/{{currentUser?.uid}}/list/{{ donor.id }}"><em class="fas fa-pencil-alt"></em></span>
                <span class="me-2 btn btn-outline-danger btn-sm" title="Delete" (click)="deleteDonor(donor)"><em
                    class="fas fa-trash-alt"></em></span>
              </div>
              <div *ngIf="!isAdmin && !donor.isSameCreator"
                class="text-center action-block d-flex justify-content-evenly py-2">
                <span *ngIf="donor.status === 'approved'" class=" me-2 btn btn-outline-success btn-sm" title="Call">
                  <a href="tel:{{donor.mobileNumber}}"><em class="fas fa-phone fa-rotate-90"></em></a>
                </span>
                <a *ngIf="!donor.status || donor.status === 'pending'" href="#"
                  (click)="requestContact($event,donor)">Request for contact</a>
                <span *ngIf="donor.status === 'on-hold'" (click)="requestContact($event,donor)">Request put on
                  hold
                  <div class="font-sm">{{donor.remarks}}</div>
                </span>
                <span *ngIf="donor.status === 'rejected'" (click)="requestContact($event,donor)">Request
                  rejected
                  <div class="font-sm">{{donor.remarks}}</div>
                </span>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <pagination-controls (pageChange)="p = $any($event)"></pagination-controls>
</div>